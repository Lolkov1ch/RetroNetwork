{% extends 'base.html' %}
{% block title %}User Search - RetroNetwork{% endblock %}

{% block content %}
<div class="panel">
  <div class="panel-header">[ User Search ]</div>
  <div class="panel-body">
    <form method="get" action="{% url 'users:user_search' %}" class="search-bar">
      <input type="search" name="q" placeholder="Search by handle, name or bio..." value="{{ search_query }}" autocomplete="off">
      <button type="submit">Search</button>
    </form>
    {% if search_query %}
      <p class="search-results-label">Results for: "{{ search_query }}"</p>
    {% endif %}
  </div>
</div>

{% if users %}
  <div class="panel">
    <div class="panel-body" style="padding:0;">
      {% for user in users %}
        <a href="{% url 'users:user_detail' user.handle %}" style="text-decoration:none;">
          <div class="user-card">
            <div class="user-card-avatar">
              {% if user.avatar %}
                <img src="{{ user.avatar.url }}" alt="avatar">
              {% else %}
                <div class="user-card-avatar-placeholder">ðŸ‘¤</div>
              {% endif %}
            </div>
            <div class="user-card-info">
              <h2>{% if user.display_name %}{{ user.display_name }}{% else %}{{ user.get_display_name }}{% endif %}</h2>
              <p class="handle">@{{ user.handle }}</p>
              {% if user.bio %}<p class="bio">{{ user.bio|truncatewords:15 }}</p>{% endif %}
            </div>
          </div>
        </a>
      {% endfor %}
    </div>
  </div>

  {% if is_paginated %}
    <div class="pagination">
      {% if page_obj.has_previous %}
        <a href="?q={{ search_query }}&page=1">Â« First</a>
        <a href="?q={{ search_query }}&page={{ page_obj.previous_page_number }}">â€¹ Prev</a>
      {% endif %}
      <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
      {% if page_obj.has_next %}
        <a href="?q={{ search_query }}&page={{ page_obj.next_page_number }}">Next â€º</a>
        <a href="?q={{ search_query }}&page={{ page_obj.paginator.num_pages }}">Last Â»</a>
      {% endif %}
    </div>
  {% endif %}

{% else %}
  <div class="panel">
    <div class="panel-body empty-state">
      {% if search_query %}// No users found for "{{ search_query }}"
      {% else %}// Enter a query to find users.{% endif %}
    </div>
  </div>
{% endif %}

{% endblock %}