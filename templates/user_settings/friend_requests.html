{% extends "base.html" %}
{% load static %}

{% block title %}Friend Requests - RetroNetwork{% endblock %}

{% block content %}
<div style="max-width: 600px;">
  <div class="panel">
    <div class="panel-header">ðŸ‘¥ Friend Requests</div>
    <div class="panel-body" style="text-align: center; padding: 20px;">
      <p style="color: #65676b; margin: 0;">Manage your pending friend requests</p>
    </div>
  </div>

  {% if friend_requests %}
    {% for request in friend_requests %}
      <div class="panel" style="margin-top: 12px;">
        <div style="padding: 12px; display: flex; align-items: center; justify-content: space-between;">
          <div style="display: flex; align-items: center; gap: 12px; flex: 1;">
            {% if request.requester.avatar %}
              <img src="{{ request.requester.avatar.url }}" alt="{{ request.requester.handle }}" style="width: 48px; height: 48px; border-radius: 50%; object-fit: cover;">
            {% else %}
              <div style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 16px; flex-shrink: 0;">
                {{ request.requester.handle|first|upper }}
              </div>
            {% endif %}
            <div style="flex: 1;">
              <div style="font-weight: 600; color: var(--text-main); font-size: 13px;">
                <a href="{% url 'users:user_detail' request.requester.handle %}" style="color: var(--text-main); text-decoration: none;">
                  {{ request.requester.get_display_name }}
                </a>
              </div>
              <div style="font-size: 11px; color: #65676b; margin-top: 2px;">
                <a href="{% url 'users:user_detail' request.requester.handle %}" style="color: #3b5998; text-decoration: none;">
                  @{{ request.requester.handle }}
                </a>
              </div>
              {% if request.requester.bio %}
                <div style="font-size: 11px; color: #65676b; margin-top: 4px;">
                  {{ request.requester.bio|truncatewords:8 }}
                </div>
              {% endif %}
            </div>
          </div>

          <div style="display: flex; gap: 6px; flex-shrink: 0; margin-left: 12px;">
            <form method="post" action="{% url 'user_settings:accept_friend_request' request.requester.handle %}" style="display: inline;">
              {% csrf_token %}
              <button type="submit" style="padding: 6px 12px; background: #31a24c; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; font-weight: 600; transition: background 0.15s ease;" onmouseover="this.style.background='#2a8a3f'" onmouseout="this.style.background='#31a24c';">âœ“ Accept</button>
            </form>
            <form method="post" action="{% url 'user_settings:reject_friend_request' request.requester.handle %}" style="display: inline;">
              {% csrf_token %}
              <button type="submit" style="padding: 6px 12px; background: #e74856; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; font-weight: 600; transition: background 0.15s ease;" onmouseover="this.style.background='#d63c47'" onmouseout="this.style.background='#e74856';">âœ• Reject</button>
            </form>
          </div>
        </div>
      </div>
    {% endfor %}

    {% if is_paginated %}
      <div style="margin-top: 20px; padding: 12px; text-align: center;">
        {% if page_obj.has_previous %}
          <a href="?page=1" style="padding: 6px 12px; background: #3b5998; color: white; text-decoration: none; border-radius: 3px; font-size: 12px; margin-right: 4px;">Â«</a>
          <a href="?page={{ page_obj.previous_page_number }}" style="padding: 6px 12px; background: #3b5998; color: white; text-decoration: none; border-radius: 3px; font-size: 12px; margin-right: 4px;">â€¹ Prev</a>
        {% endif %}

        <span style="font-size: 12px; color: #65676b; padding: 0 8px;">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}" style="padding: 6px 12px; background: #3b5998; color: white; text-decoration: none; border-radius: 3px; font-size: 12px; margin-left: 4px;">Next â€º</a>
          <a href="?page={{ page_obj.paginator.num_pages }}" style="padding: 6px 12px; background: #3b5998; color: white; text-decoration: none; border-radius: 3px; font-size: 12px; margin-left: 4px;">Â»</a>
        {% endif %}
      </div>
    {% endif %}
  {% else %}
    <div class="panel" style="margin-top: 12px;">
      <div class="panel-body" style="text-align: center; padding: 40px 20px;">
        <div style="font-size: 36px; margin-bottom: 12px;">âœ“</div>
        <p style="color: #65676b; font-size: 13px; margin: 0;">No pending friend requests</p>
        <p style="color: #999; font-size: 12px; margin-top: 8px;">You're all caught up!</p>
        <a href="{% url 'users:user_search' %}" style="display: inline-block; margin-top: 12px; padding: 8px 16px; background: #3b5998; color: white; text-decoration: none; border-radius: 3px; font-size: 12px;">Find Friends</a>
      </div>
    </div>
  {% endif %}

</div>
{% endblock %}
